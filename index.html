<!-- Novo Estilo das Barras de Progresso -->
<style>
    .analysis-item { margin-bottom: 20px; text-align: left; }
    .analysis-label { font-size: 12px; font-weight: 700; margin-bottom: 5px; display: flex; justify-content: space-between; }
    .progress-container { width: 100%; height: 12px; background: #222; border-radius: 10px; overflow: hidden; border: 1px solid #333; }
    .progress-bar-fill { height: 100%; width: 0%; background: var(--primary); transition: width 0.5s ease, background 0.3s ease; }
    .progress-bar-fill.complete { background: #22c55e; }
    .status-tag { font-size: 10px; padding: 2px 6px; border-radius: 4px; background: #333; }
    .status-tag.complete { background: #22c55e; color: #000; }
</style>

<!-- Tela 4: Processamento de Resultados Ultra Visual -->
<div id="s-3" class="screen">
    <div class="fixed-header">SISTEMA DE DIAGNÓSTICO AVANÇADO</div>
    <h2 style="font-size: 22px; font-weight: 900; margin-bottom: 15px;">ANALISANDO DADOS BIOMÉTRICOS...</h2>
    
    <div class="carousel" id="depo-carousel">
        <div class="slide active">
            <img src="https://protocolotripe.online/wp-content/uploads/2026/01/PACIENTE-H-2990-ANTES-E-DEPOIS-1-1-scaled-1.webp">
            <div class="slide-caption">PACIENTE H. LIMA: +5.2cm (CONFIRMADO )</div>
        </div>
        <div class="slide">
            <img src="https://protocolotripe.online/wp-content/uploads/2026/01/daf6ef_d639bfc5b0a34189b18c48e3f54f2763_mv2.png">
            <div class="slide-caption">PACIENTE A. COSTA: +6.1cm (CONFIRMADO )</div>
        </div>
        <div class="slide">
            <img src="https://protocolotripe.online/wp-content/uploads/2026/01/Sample-photo-fotor-202601270541.png">
            <div class="slide-caption">PACIENTE J. GOMES: +4.7cm (CONFIRMADO )</div>
        </div>
    </div>

    <div id="analysis-box" style="margin-top: 25px;">
        <div class="analysis-item">
            <div class="analysis-label"><span>FLUXO SANGUÍNEO CAVERNOSO</span> <span id="st-1" class="status-tag">PROCESSANDO</span></div>
            <div class="progress-container"><div id="pb-1" class="progress-bar-fill"></div></div>
        </div>
        <div class="analysis-item">
            <div class="analysis-label"><span>DENSIDADE TECIDUAL (CORPO ESPONJOSO)</span> <span id="st-2" class="status-tag">AGUARDANDO</span></div>
            <div class="progress-container"><div id="pb-2" class="progress-bar-fill"></div></div>
        </div>
        <div class="analysis-item">
            <div class="analysis-label"><span>COMPATIBILIDADE COM PROTOCOLO TRIPE</span> <span id="st-3" class="status-tag">AGUARDANDO</span></div>
            <div class="progress-container"><div id="pb-3" class="progress-bar-fill"></div></div>
        </div>
    </div>
</div>

<script>
    // Nova Lógica de Processamento Visual
    function startProcessing() {
        let sIdx = 0; const slides = document.querySelectorAll('#depo-carousel .slide');
        const interval = setInterval(() => { slides.forEach(s => s.classList.remove('active')); sIdx = (sIdx + 1) % slides.length; slides[sIdx].classList.add('active'); }, 2000);
        
        // Etapa 1
        setTimeout(() => { 
            document.getElementById('pb-1').style.width = '100%'; 
            document.getElementById('pb-1').classList.add('complete');
            document.getElementById('st-1').innerText = 'VALIDADO';
            document.getElementById('st-1').classList.add('complete');
            document.getElementById('st-2').innerText = 'PROCESSANDO';
        }, 2500);

        // Etapa 2
        setTimeout(() => { 
            document.getElementById('pb-2').style.width = '100%'; 
            document.getElementById('pb-2').classList.add('complete');
            document.getElementById('st-2').innerText = 'VALIDADO';
            document.getElementById('st-2').classList.add('complete');
            document.getElementById('st-3').innerText = 'PROCESSANDO';
        }, 5000);

        // Etapa 3
        setTimeout(() => { 
            document.getElementById('pb-3').style.width = '100%'; 
            document.getElementById('pb-3').classList.add('complete');
            document.getElementById('st-3').innerText = 'COMPATÍVEL';
            document.getElementById('st-3').classList.add('complete');
        }, 7500);

        setTimeout(() => { clearInterval(interval); step = 4; startCountdown(); render(); }, 9000);
    }
</script>
